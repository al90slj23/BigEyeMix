# 02.deploy.guide - BigEyeMix éƒ¨ç½²æŒ‡å—

> **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0.0
> **åˆ›å»ºæ—¥æœŸ**ï¼š2025-01-15

---

## ğŸ“ æ–‡æ¡£å®šä½

æœ¬æ–‡æ¡£å®šä¹‰ BigEyeMix é¡¹ç›®çš„éƒ¨ç½²æµç¨‹å’ŒæœåŠ¡å™¨é…ç½®ã€‚

---

## ğŸš€ å¿«é€Ÿéƒ¨ç½²

### æ–¹æ³• 1: ä½¿ç”¨ go.shï¼ˆæ¨èï¼‰

```bash
./go.sh 1    # éƒ¨ç½²ï¼ˆé»˜è®¤é€‰é¡¹ï¼‰
# æˆ–ç›´æ¥å›è½¦ï¼Œ10ç§’åè‡ªåŠ¨æ‰§è¡Œéƒ¨ç½²
```

### æ–¹æ³• 2: æ‰‹åŠ¨éƒ¨ç½²

```bash
# åŒæ­¥æ–‡ä»¶
rsync -avz web/ root@bem.it.sc.cn:/www/wwwroot/bem.it.sc.cn/web/
rsync -avz api/ root@bem.it.sc.cn:/www/wwwroot/bem.it.sc.cn/api/

# æ›´æ–°é…ç½®
scp deploy/bem.it.sc.cn.conf root@bem.it.sc.cn:/www/server/panel/vhost/nginx/

# é‡å¯æœåŠ¡
ssh root@bem.it.sc.cn 'nginx -t && nginx -s reload'
ssh root@bem.it.sc.cn 'pm2 restart bigeye.api'
```

---

## ğŸ“ æœåŠ¡å™¨ç›®å½•ç»“æ„

```
/www/wwwroot/bem.it.sc.cn/
â”œâ”€â”€ web/
â”‚   â”œâ”€â”€ home/
â”‚   â”‚   â””â”€â”€ index.html
â”‚   â”œâ”€â”€ muggle/
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â””â”€â”€ main.js
â”‚   â””â”€â”€ wizard/
â”‚       â””â”€â”€ index.html
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py
â”‚   â”œâ”€â”€ requirements.txt
â”‚   â”œâ”€â”€ uploads/
â”‚   â””â”€â”€ outputs/
â””â”€â”€ deploy/
    â”œâ”€â”€ bem.it.sc.cn.conf
    â””â”€â”€ pm2.config.js
```

---

## âœ… éƒ¨ç½²éªŒè¯

### æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
./go.sh 2    # çŠ¶æ€æ£€æŸ¥é€‰é¡¹
```

### æ‰‹åŠ¨æ£€æŸ¥

```bash
# PM2 è¿›ç¨‹
ssh root@bem.it.sc.cn 'pm2 status'

# Nginx é…ç½®
ssh root@bem.it.sc.cn 'nginx -t'

# API æ—¥å¿—
ssh root@bem.it.sc.cn 'pm2 logs bigeye.api --lines 50'
```

### è®¿é—®æµ‹è¯•

| é¡µé¢ | URL |
|------|-----|
| é¦–é¡µ | https://bem.it.sc.cn/ |
| éº»ç“œæ¨¡å¼ | https://bem.it.sc.cn/muggle |
| å·«å¸ˆæ¨¡å¼ | https://bem.it.sc.cn/wizard |
| API æ–‡æ¡£ | https://bem.it.sc.cn/api/docs |

---

## ğŸ› æ•…éšœæ’æŸ¥

### API æ— å“åº”

```bash
# æ£€æŸ¥è¿›ç¨‹
ssh root@bem.it.sc.cn 'pm2 status'

# æŸ¥çœ‹æ—¥å¿—
ssh root@bem.it.sc.cn 'pm2 logs bigeye.api --lines 50'

# é‡å¯æœåŠ¡
ssh root@bem.it.sc.cn 'pm2 restart bigeye.api'
```

### é¡µé¢ 404

```bash
# æ£€æŸ¥æ–‡ä»¶
ssh root@bem.it.sc.cn 'ls -la /www/wwwroot/bem.it.sc.cn/web/'

# æ£€æŸ¥ Nginx
ssh root@bem.it.sc.cn 'nginx -t'
ssh root@bem.it.sc.cn 'nginx -s reload'
```

### ä¸Šä¼ å¤±è´¥

```bash
# æ£€æŸ¥ç›®å½•æƒé™
ssh root@bem.it.sc.cn 'ls -la /www/wwwroot/bem.it.sc.cn/api/uploads/'

# åˆ›å»ºç›®å½•
ssh root@bem.it.sc.cn 'mkdir -p /www/wwwroot/bem.it.sc.cn/api/{uploads,outputs}'
ssh root@bem.it.sc.cn 'chmod 755 /www/wwwroot/bem.it.sc.cn/api/{uploads,outputs}'
```

---

## ğŸ”§ ç»´æŠ¤ä»»åŠ¡

### æ—¥å¸¸ç»´æŠ¤

```bash
# æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼ˆ7å¤©å‰ï¼‰
ssh root@bem.it.sc.cn 'find /www/wwwroot/bem.it.sc.cn/api/uploads/ -mtime +7 -delete'
ssh root@bem.it.sc.cn 'find /www/wwwroot/bem.it.sc.cn/api/outputs/ -mtime +7 -delete'

# æ¸…ç† PM2 æ—¥å¿—
ssh root@bem.it.sc.cn 'pm2 flush'
```

### ç›‘æ§æŒ‡æ ‡

```bash
# ç£ç›˜ç©ºé—´
ssh root@bem.it.sc.cn 'df -h /www/wwwroot/bem.it.sc.cn'

# å†…å­˜ä½¿ç”¨
ssh root@bem.it.sc.cn 'pm2 monit'
```

---

**æœ€åæ›´æ–°**ï¼š2025-01-15
