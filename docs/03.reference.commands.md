# 03.reference.commands - å¸¸ç”¨å‘½ä»¤å‚è€ƒ

> **æ–‡æ¡£ç‰ˆæœ¬**ï¼šv1.0.0
> **åˆ›å»ºæ—¥æœŸ**ï¼š2025-01-15

---

## ğŸ“ æ–‡æ¡£å®šä½

æœ¬æ–‡æ¡£æä¾› BigEyeMix é¡¹ç›®çš„å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥ã€‚

---

## ğŸš€ go.sh ç»Ÿä¸€å…¥å£

```bash
./go.sh        # äº¤äº’å¼èœå•ï¼ˆ10ç§’æ— è¾“å…¥è‡ªåŠ¨éƒ¨ç½²ï¼‰
./go.sh 0      # æœ¬åœ°å¼€å‘
./go.sh 1      # éƒ¨ç½²ï¼ˆé»˜è®¤ï¼‰
./go.sh 2      # çŠ¶æ€æ£€æŸ¥
./go.sh 3      # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
```

---

## ğŸ’» æœ¬åœ°å¼€å‘

### å¯åŠ¨åç«¯

```bash
cd api
python3.11 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn main:app --reload --port 8000
```

### å¯åŠ¨å‰ç«¯

```bash
cd web
python3 -m http.server 8080
```

### è®¿é—®åœ°å€

| é¡µé¢ | URL |
|------|-----|
| é¦–é¡µ | http://localhost:8080/home/ |
| éº»ç“œæ¨¡å¼ | http://localhost:8080/muggle/ |
| API æ–‡æ¡£ | http://localhost:8000/docs |

---

## ğŸ“¦ éƒ¨ç½²å‘½ä»¤

### åŒæ­¥æ–‡ä»¶

```bash
# åŒæ­¥å‰ç«¯
rsync -avz web/ root@bem.it.sc.cn:/www/wwwroot/bem.it.sc.cn/web/

# åŒæ­¥åç«¯
rsync -avz api/ root@bem.it.sc.cn:/www/wwwroot/bem.it.sc.cn/api/

# æ›´æ–° Nginx é…ç½®
scp deploy/bem.it.sc.cn.conf root@bem.it.sc.cn:/www/server/panel/vhost/nginx/
```

### é‡å¯æœåŠ¡

```bash
ssh root@bem.it.sc.cn 'nginx -t && nginx -s reload'
ssh root@bem.it.sc.cn 'pm2 restart bigeye.api'
```

---

## ğŸ” æœåŠ¡å™¨ç®¡ç†

### PM2 å‘½ä»¤

```bash
# æŸ¥çœ‹çŠ¶æ€
ssh root@bem.it.sc.cn 'pm2 status'

# æŸ¥çœ‹æ—¥å¿—
ssh root@bem.it.sc.cn 'pm2 logs bigeye.api'
ssh root@bem.it.sc.cn 'pm2 logs bigeye.api --lines 50'

# é‡å¯æœåŠ¡
ssh root@bem.it.sc.cn 'pm2 restart bigeye.api'

# åœæ­¢æœåŠ¡
ssh root@bem.it.sc.cn 'pm2 stop bigeye.api'

# å¯åŠ¨æœåŠ¡
ssh root@bem.it.sc.cn 'pm2 start /www/wwwroot/bem.it.sc.cn/deploy/pm2.config.js'

# ä¿å­˜é…ç½®
ssh root@bem.it.sc.cn 'pm2 save'

# ç›‘æ§
ssh root@bem.it.sc.cn 'pm2 monit'

# æ¸…ç†æ—¥å¿—
ssh root@bem.it.sc.cn 'pm2 flush'
```

### Nginx å‘½ä»¤

```bash
# æµ‹è¯•é…ç½®
ssh root@bem.it.sc.cn 'nginx -t'

# é‡å¯
ssh root@bem.it.sc.cn 'nginx -s reload'

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
ssh root@bem.it.sc.cn 'tail -f /www/wwwlogs/bem.it.sc.cn.log'

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
ssh root@bem.it.sc.cn 'tail -f /www/wwwlogs/bem.it.sc.cn.error.log'
```

---

## ğŸ§ª API æµ‹è¯•

```bash
# å¥åº·æ£€æŸ¥
curl https://bem.it.sc.cn/api/health

# ä¸Šä¼ æµ‹è¯•
curl -X POST https://bem.it.sc.cn/api/upload \
  -F "file=@test.mp3" \
  -H "Content-Type: multipart/form-data"

# æ··éŸ³æµ‹è¯•
curl -X POST https://bem.it.sc.cn/api/mix \
  -H "Content-Type: application/json" \
  -d '{
    "track_a_id": "file_id_1",
    "track_b_id": "file_id_2",
    "transition_duration": 4
  }'
```

---

## ğŸ§¹ ç»´æŠ¤å‘½ä»¤

```bash
# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
ssh root@bem.it.sc.cn 'find /www/wwwroot/bem.it.sc.cn/api/uploads/ -mtime +7 -delete'
ssh root@bem.it.sc.cn 'find /www/wwwroot/bem.it.sc.cn/api/outputs/ -mtime +7 -delete'

# æ£€æŸ¥ç£ç›˜ç©ºé—´
ssh root@bem.it.sc.cn 'df -h /www/wwwroot/bem.it.sc.cn'

# æ£€æŸ¥ç›®å½•å¤§å°
ssh root@bem.it.sc.cn 'du -sh /www/wwwroot/bem.it.sc.cn/*'
```

---

**æœ€åæ›´æ–°**ï¼š2025-01-15
